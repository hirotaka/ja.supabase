---
id: local-development
title: ローカル開発環境
description: ローカルの開発マシンでSupabaseを使用する方法。
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

SupabaseはCLIを提供しているので、ローカルでアプリケーションを開発し、そのアプリケーションをSupabaseプラットフォームにデプロイできます。

<<<<<<< HEAD
## はじめに

### 前提条件

お使いの環境に以下のものが必要です。

- Git
- Docker（デーモンが起動していることを確認してください）
- Supabase CLI（手順は[こちら](https://github.com/supabase/cli)を参照）

### プロジェクトを初期化
=======
## Prerequisites

### Dependencies

Before we begin, make sure you have these installed on your local machine:

- Git. [Docs](https://github.com/git-guides/install-git)
- Docker (make sure this is running). [Docs](https://docs.docker.com/engine/install/)
- Supabase CLI. [Docs](/docs/reference/cli/installing-and-updating)

### Supabase CLI login

After installing the Supabase CLI you can [log in](/docs/reference/cli/supabase-login) using your Supabase account (sign up at [app.supabase.io](https://app.supabase.io)).

```bash
supabase login
```

This is a one-time operation. After you have logged in the CLI will have permissions to manage your Supabase projects.

## Getting started

### Initialize your project 
>>>>>>> 21f9e79799bdc37278951c1e0cf600422d38cf25

Let's create a new folder on your local machine:

```bash
# プロジェクト・フォルダーを作成
mkdir your-project

# 作成したフォルダーに移動
cd your-project

# gitリポジトリを処理化
git init
```

<<<<<<< HEAD
このコマンドにより、プロジェクト用に空のフォルダーを作成し、新しいgitリポジトリーをはじめることができます。
=======
These commands will create an empty folder for your project and start a new git repository.
>>>>>>> 21f9e79799bdc37278951c1e0cf600422d38cf25

### Supabaseを初期化

Let's [initialize](/docs/reference/cli/supabase-init) Supabase inside the folder that you created:

```bash
supabase init
```

このコマンドを実行すると、ローカルでプロジェクトを開発するためのすべての設定を保持する`supabase`フォルダーが作成されます。

<<<<<<< HEAD
### リーモート・プロジェクト

任意のローカルにあるプロジェクトをリモートのデータベースにリンクできます。ここでは、Supabaseプロジェクトの接続文字列を使用します。

```bash
supabase db remote set 'postgresql://postgres:<your_password>@db.<your_project_ref>.supabase.co:5432/postgres'
```

その後、次を実行します。

```bash
supabase db remote commit
```

このコマンドは、CLIをセットアップする前にデータベースへ加えたすべての変更を取り込みます。

`supabase/migrations`に `..._remote_commit.sql`というマイグレーションが追加されていることを確認できます。
このマイグレーションは、リモートのSupabaseプロジェクトのスキーマと一致させるために、ローカルのデータベースに加えた必要な変更を取り込みます。
=======
## Developing Locally
>>>>>>> 21f9e79799bdc37278951c1e0cf600422d38cf25

### Supabaseを開始

```bash
supabase start
```

<<<<<<< HEAD
このコマンドはDockerを使用して、Supabaseのすべてのオープンソースな[サービス](/docs/#how-it-works)を開始します。
このコマンドは、ビルドするサービスが多いため、実行に時間がかかります。
=======
The [start](/docs/reference/cli/supabase-start) command uses Docker to start the open source [services](/docs/#how-it-works) of Supabase. 
This command may take a while to run if this is the first time using the CLI.
>>>>>>> 21f9e79799bdc37278951c1e0cf600422d38cf25

このコマンドが実行されると、ローカルのSupabaseの認証情報を含む出力が表示されます。

<<<<<<< HEAD
### サービスに直接アクセスする
=======
You can use the [stop](/docs/reference/cli/supabase-stop) command at any time to stop all services.

### Accessing Services Directly
>>>>>>> 21f9e79799bdc37278951c1e0cf600422d38cf25

<Tabs
defaultValue="Postgres"
values={[
  {label: 'Postgres', value: 'Postgres'},
  {label: 'API Gateway', value: 'Kong'},
]}>
<TabItem value="Postgres">

```sh
# デフォルトURL:
postgresql://postgres:postgres@localhost:54322/postgres
```

ローカルのPostgresインスタンスは、[`psql`](https://www.postgresql.org/docs/current/app-psql.html)や、
[pgadmin](https://www.pgadmin.org/)などのPostgresクライアントからアクセスできます。

例えば、以下のようになります。

```bash
psql 'postgresql://postgres:postgres@localhost:54322/postgres'
```

</TabItem>
<TabItem value="Kong">

```sh
# Default URL:
http://localhost:54321
```

すべてのサービスは、APIゲートウェイの[Kong](https://github.com/Kong/kong)を経由してアクセス可能です。
クライアント・ライブラリーを使用せず、これらのサービスにアクセスする際、`Authorization`ヘッダーとしてクライアント・キーを渡す必要のある場合があります。
これらのJWTヘッダーの詳細については、こちらの[リソース](/docs/learn/auth-deep-dive/auth-deep-dive-jwts)を参照してください。

```sh
curl 'http://localhost:54321/rest/v1/' \
    -H "apikey: <anon key>" \
    -H "Authorization: Bearer <anon key>"

http://localhost:54321/rest/v1/           # REST (PostgREST)
http://localhost:54321/realtime/v1/       # Realtime
http://localhost:54321/storage/v1/        # Storage
http://localhost:54321/auth/v1/           # Auth (GoTrue)
```

</TabItem>
</Tabs>

<<<<<<< HEAD
### Supabaseを停止
=======
>>>>>>> 21f9e79799bdc37278951c1e0cf600422d38cf25

### Database Migrations

<<<<<<< HEAD
Supabaseのサービスを停止して、次は実際のアプリケーションを構築してみましょう。

## マイグレーション

また、CLIを使用してマイグレーションを管理できます。 


## 2. データベースを変更する

ローカルのデータベースを変更するには、`supabase start`で表示される`DB URL`に対してSQLを実行するだけです。 

この例では、提供されている「Supabase Studio」のリンクを使用して、`employees`という名前のテーブルを作成します。 
Studioを開き、「SQL Editor」セクションに移動し、以下のSQLコマンドを実行します。
=======
Database changes are managed through "migrations". Database migrations are a common way of tracking changes to your database over time. 


#### Making database changes

For this guild, let's create a table called `employees`, using the "Supabase Studio" link provided. 

:::note 

If you're familiar with databases, you can also execute any SQL using the `DB URL` shown by `supabase start`. 

::: 

Open the Studio, navigate to the "SQL Editor" section, and run the following SQL command:
>>>>>>> 21f9e79799bdc37278951c1e0cf600422d38cf25

```sql
create table employees (
	id serial primary key,
	name text
);
```

<<<<<<< HEAD
さて、ローカルのデータベースに`employees`テーブルがありますが、これをどのようにマイグレーションに組み込むのでしょうか。CLIで次を実行すると自動的に変更を検出できます。
=======
Now we have the `employees` table in the local database, but how do we incorporate this into migrations? The CLI automatically detects changes by running the [commit](/docs/reference/cli/supabase-db-commit) command:
>>>>>>> 21f9e79799bdc37278951c1e0cf600422d38cf25

```sh
supabase db commit create_employees
```

<<<<<<< HEAD
これは `<タイムスタンプ>_create_employees.sql`という名前の新しいマイグレーションを作成します。そして、`supabase start`以降のローカルのデータベースに対するすべての変更を反映します。

サンプルのデータをテーブルに追加してみましょう。そのためには、`supabase/seed.sql`のシード・スクリプトを利用できます。 
=======
This creates a new migration named `<timestamp>_create_employees.sql`, representing any changes we've made to the local database since `supabase start`.

Let's add some sample data into the table. We can use the seed script in `supabase/seed.sql`. 
>>>>>>> 21f9e79799bdc37278951c1e0cf600422d38cf25

```sql
-- in supabase/seed.sql
insert into employees (id, name) 
values 
  (1, 'Erlich Backman'), 
  (2, 'Richard Hendricks'),
  (3, 'Monica Hall');
```

ここで、以下を実行して、マイグレーション・スクリプトとシード・スクリプトを再実行します。

```bash
supabase db reset
```

Studioでもう一度見てみると、今度は`employees`の中身が見えるはずです。 

<<<<<<< HEAD
## 3. データベースの変更をリセットする
=======
#### Resetting database changes
>>>>>>> 21f9e79799bdc37278951c1e0cf600422d38cf25

もし、ローカルのデータベース上で実行したSQLを元に戻したい場合には、`reset`コマンドを使用できます。

```sql
-- ローカルのデータベースで実行
alter table employees 
  add department text default 'Hooli';
```

この変更を元に戻すには、次のように実行します。

```sh
supabase db reset
```

そうすると、ローカルのデータベースはリセットされます。

<<<<<<< HEAD
## 4. マイグレーションをデプロイする

最後に、これらのローカルで行った変更をリモートのデータベース（つまり、リモートのSupabaseプロジェクト）にデプロイする必要があります。 
これを行うには、以下を実行します。 
=======
## Deploying 

Now that you've developed an application locally, head over to [app.supabase.io](https://app.supabase.io) and create a project where we can deploy the changes.

### Linking your project 

:::note 

There are a few commands required to link your project. We are in the process of consolidating these commands into a single command. Bear with us!

::: 

Let's associate your project with your remote project using [supabase link](/docs/guides/local-development) and [db remote set](/docs/reference/cli/supabase-db-remote-set)


```bash

supabase link 
# Use "supabase link --project-ref your-project-ref" to link your project in one step.

supabase db remote set 'postgresql://postgres:<your_password>@db.<your_project_ref>.supabase.co:5432/postgres'
# Use the connection string from your Supabase project here.

supabase db remote commit
# capture any changes that you have made to your database before setting up the CLI
```

You'll notice that `supabase/migrations` is now populated with a migration in `..._remote_commit.sql`. 
This migration captures any changes required for your local database to match the schema of your remote Supabase project.


### Deploying Database changes

You can deploy any local database migrations using [`db push`](/docs/reference/cli/supabase-db-push):
>>>>>>> 21f9e79799bdc37278951c1e0cf600422d38cf25

```sh
supabase db push
```

<<<<<<< HEAD
## 次のステップ
=======
### Deploying Edge Functions

Coming soon!

## Next steps
>>>>>>> 21f9e79799bdc37278951c1e0cf600422d38cf25

- 何か疑問があれば、[Diiscussionsで質問](https://github.com/supabase/supabase/discussions)してください
- CLIのリポジトリ：[GitHub](https://github.com/supabase/cli)
- サインイン：[app.supabase.io](https://app.supabase.io)
