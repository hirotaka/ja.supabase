---
id: local-development
title: ローカル開発環境
description: ローカルの開発マシンでSupabaseを使用する方法。
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

<<<<<<< HEAD
SupabaseはCLIを提供しているので、実際のプロジェクトに接続するのではなく、ローカルでアプリケーションを開発できます。
=======
Supabase provides a CLI so that you can develop your application locally, with the ability to deploy your application to the Supabase platform.
>>>>>>> ea620e064e197d62646895e4a1bbe621a05553b3

## はじめに

### 前提条件

お使いの環境に以下のものが必要です。

- Git
- Docker（デーモンが起動していることを確認してください）
- Supabase CLI（手順は[こちら](https://github.com/supabase/cli)を参照）

### プロジェクトを初期化

```bash
# create your project folder
mkdir your-project

# move into the new folder
cd your-project

# start a new git repository
git init
```

このコマンドにより、プロジェクト用に空のフォルダーを作成し、新しいgitリポジトリーをはじめることができます。

### Supabaseを初期化

```bash
supabase init
```

このコマンドを実行すると、ローカルでプロジェクトを開発するためのすべての設定を保持する`supabase`フォルダーが作成されます。

<<<<<<< HEAD
### Supabaseを開始
=======
### Remote project 

We can link any local project to a remote database. Use the connection string from your Supabase project here.

```bash
supabase db remote set 'postgresql://postgres:<your_password>@db.<your_project_ref>.supabase.co:5432/postgres'
```

After that, run:

```bash
supabase db remote commit
```

This command captures any changes that you have made to your database before setting up the CLI.

You'll notice that `supabase/migrations` is now populated with a migration in `..._remote_commit.sql`. 
This migration captures all the changes required on your local database to match the schema of your remote Supabase project.

### Start Supabase
>>>>>>> ea620e064e197d62646895e4a1bbe621a05553b3

```bash
supabase start
```

<<<<<<< HEAD
このコマンドはDockerを使用して、Supabaseのすべてのオープンソースな[サービス](/docs/#how-it-works)を開始します。このコマンドは、ビルドするサービスが多いため、実行に時間がかかります。

このコマンドが実行されると、ローカルのSupabaseの認証情報を含む出力が表示されます。

```txt
Started local development setup.

         API URL: http://localhost:54321
          DB URL: postgresql://postgres:postgres@localhost:54322/postgres
      Studio URL: http://localhost:54323
        anon key: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiJ9.ZopqoUt20nEV9cklpv9e3yw3PVyZLmKs5qLD6nGL1SI
service_role key: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoic2VydmljZV9yb2xlIn0.M2d2z4SFn5C7HlJlaSLfrzuYim9nbY_XI40uWFN3hEE
```

これで、ブラウザーを開いて、[http://localhost:54323](http://localhost:54323)にあるStudioへアクセスできます。
=======
The `supabase start` command uses Docker to start the open source [services](/docs/#how-it-works) of Supabase. 
This command may take a while to run if this is the first time using the CLI.

Once all of the Supabase services are running, you'll see an output that contains your local Supabase credentials.
>>>>>>> ea620e064e197d62646895e4a1bbe621a05553b3

### サービスに直接アクセスする

<Tabs
defaultValue="Postgres"
values={[
  {label: 'Postgres', value: 'Postgres'},
  {label: 'API Gateway', value: 'Kong'},
]}>
<TabItem value="Postgres">

```sh
# デフォルトURL:
postgresql://postgres:postgres@localhost:54322/postgres
```

ローカルのPostgresインスタンスは、[`psql`](https://www.postgresql.org/docs/current/app-psql.html)や、[pgadmin](https://www.pgadmin.org/)などのPostgresクライアントからアクセスできます。

例えば、以下のようになります。

```bash
psql 'postgresql://postgres:postgres@localhost:54322/postgres'
```

</TabItem>
<TabItem value="Kong">

```sh
# Default URL:
http://localhost:54321
```

すべてのサービスは、APIゲートウェイの[Kong](https://github.com/Kong/kong)を経由してアクセス可能です。
クライアント・ライブラリーを使用せず、これらのサービスにアクセスする際、`Authorization`ヘッダーとしてクライアント・キーを渡す必要のある場合があります。
これらのJWTヘッダーの詳細については、こちらの[リソース](/docs/learn/auth-deep-dive/auth-deep-dive-jwts)を参照してください。

```sh
curl 'http://localhost:54321/rest/v1/' \
    -H "apikey: <anon key>" \
    -H "Authorization: Bearer <anon key>"

http://localhost:54321/rest/v1/           # REST (PostgREST)
http://localhost:54321/realtime/v1/       # Realtime
http://localhost:54321/storage/v1/        # Storage
http://localhost:54321/auth/v1/           # Auth (GoTrue)
```

</TabItem>
</Tabs>

### Supabaseを停止

```bash
supabase stop
```

Supabaseのサービスを停止して、次は実際のアプリケーションを構築してみましょう。

<<<<<<< HEAD

## アプリケーション例

Supabaseをローカルにインストールして起動する方法を学んだところで、フロントエンドのアプリケーションで使用する方法を見ていきましょう。
このクイックスタート・ガイドでは、Supabaseスタックを使用するReactアプリケーションをどのように構成するかを説明します。

```bash
# 新しいReactアプリを作成
npx create-react-app react-demo --use-npm

# 作成したフォルダーに移動
cd react-demo

# Supabaseをセットアップ
supabase init

# supabase-jsライブラリーをインストールして保存
npm install --save @supabase/supabase-js
```

アプリケーションの準備ができたら、バックエンドを起動します。

```bash
supabase start  # Supabaseを起動
```

Supabaseは、アプリケーションのどこでも使用できます。以下のスニペットを`src/App.js`にコピーしてください。

```js
import { createClient } from '@supabase/supabase-js'

const SUPABASE_URL = '<your API URL>'
const SUPABASE_ANON_KEY = '<your anon key>'

const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY)
```

次に、別の端末でフロントエンドを起動します。

```bash
npm start       # Reactアプリを起動
```

問題がなければ、`http://localhost:3000`上でReactアプリが動作し、`http://localhost:54321`上でSupabaseサービスが動作しているはずです。

Supabaseを使い終わったら、<kbd>Ctrl-C</kbd>を押してDockerサービスを停止して、次のコマンドを実行します。

```bash
supabase stop   # Stop Supabase
```

Supabaseのサービスを停止します。

## マイグレーション

CLIを使ってマイグレーションを管理できます。[こちらの](https://github.com/supabase/cli/tree/main/examples/tour)ツアーに沿って始めてみましょう。
=======
## Migrations

You can also use the CLI to manage your migrations. 


## 2. Making database changes

To modify your local database, simply run some SQL against the `DB URL` shown by `supabase start`. 

For this example, we'll create a table called `employees`, using the "Supabase Studio" link provided. 
Open the Studio, navigate to the "SQL Editor" section, and then run the following SQL command:

```sql
create table employees (
	id serial primary key,
	name text
);
```

Now we have the `employees` table in the local database, but how do we incorporate this into migrations? The CLI can automatically detect changes by running:

```sh
supabase db commit create_employees
```

This will create a new migration named `<timestamp>_create_employees.sql` that represents any changes we've made to the local database since `supabase start`.

Let's add some sample data into the table. To do this we can use the seed script in `supabase/seed.sql`. 

```sql
-- in supabase/seed.sql
insert into employees (id, name) 
values 
  (1, 'Erlich Backman'), 
  (2, 'Richard Hendricks'),
  (3, 'Monica Hall');
```

Now run the following to rerun the migration scripts and the seed script:

```bash
supabase db reset
```

If you look again within Studio, you should now see the contents of `employees`. 

## 3. Resetting database changes

If you run any SQL on the local database that you want to revert, you can use the `reset` command.

```sql
-- run on local database
alter table employees 
  add department text default 'Hooli';
```

To revert this change we can run:

```sh
supabase db reset
```

And the local database will be reset.

## 4. Deploying migrations

Finally, we need to deploy these local changes to the remote database (i.e. your remote Supabase project). 
We can do this by running: 

```sh
supabase db push
```
>>>>>>> ea620e064e197d62646895e4a1bbe621a05553b3

## 次のステップ

<<<<<<< HEAD
- 何か疑問があれば、[ここで質問](https://github.com/supabase/supabase/discussions)してください
- CLIのリポジトリ：[GitHub](https://github.com/supabase/cli)
- サインイン：[app.supabase.io](https://app.supabase.io)
=======
- Got a question? [Ask in our Discussions](https://github.com/supabase/supabase/discussions).
- CLI repository: [GitHub](https://github.com/supabase/cli).
- Sign in: [app.supabase.io](https://app.supabase.io)
>>>>>>> ea620e064e197d62646895e4a1bbe621a05553b3
