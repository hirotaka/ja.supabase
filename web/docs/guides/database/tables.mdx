---
id: tables
title: テーブル
description: Creating and using Postgres tables.
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';


Postgresでは、データは「テーブル」に格納されます。
テーブルはExcelのスプレッドシートに似ています。データの列と行を含んでいます。しかし、スプレッドシートとはいくつかの重要な違いがあります。

- すべての列は厳格なデータの種類です。列を設定する際には、「データタイプ」を定義する必要があります。
- テーブルは互いに「結合」できます。例えば、`users`（ユーザー）テーブルがあり、それが`teams`（チーム）テーブルに結合されています（ユーザーはチームに属しているため）。

例えば、このテーブルには3つの「列」（`id`, `name`, `description`）と4つの「行」のデータがあります。

| `id`    | `name` | `description` |
| ----  | ---- | ----------- |
|    1 | Toy Story | When a new toy called "Forky" 結合s Woody and the gang, a road trip alongside old and new friends reveals how big the world can be for a toy. |
|    2 | Monsters, Inc. | In order to power the city, monsters have to scare children so that they scream. However, the children are toxic to monsters. |
|    3 | Finding Nemo | After his son is captured in the Great Barrier Reef and taken to Sydney, a timid clownfish sets out on a journey to bring him home. |
|    4 | WALL-E | In the distant future, a small waste-collecting robot inadvertently embarks on a space journey that will ultimately decide the fate of mankind. |

<!-- textlint-disable -->
There are a few important differences from a spreadsheet, but it's a good starting point if you're new to Relational databases.
<!-- textlint-enable -->

## テーブルの作成

Supabaseには、テーブルを作成するためのいくつかの選択肢があります。テーブル・エディターを使用するか、SQLを直接使用して作成できます。
ダッシュボードにはSQLエディターが用意されていますが、データベースに[接続して](/docs/guides/database/connecting/connecting-to-postgres)、SQLクエリを実行できます。


<Tabs
defaultValue="UI"
values={[
  {label: 'Dashboard', value: 'UI'},
  {label: 'SQL', value: 'SQL'},
]}>
<TabItem value="UI">


<video width="99%" muted playsInline controls="true">
<source src="/docs/videos/api/api-create-table-sm.mp4" type="video/mp4" muted playsInline />
</video>

```sh
1. 「Table editor」のセクションに移動します。
2. 「New Table」をクリックします。
3. 「todos」というテーブル名を入力します。
4. 「Save」をクリックします。
5. 「New Column」をクリックします。
6. 「task」というカラム名を入力して、タイプを「text」にします。
7. 「Save」をクリックします。.
```

</TabItem>
<TabItem value="SQL">

```sql
-- タスクを格納する列を持つ「todos」というテーブルを作成します。

create table todos (
  id bigint generated by default as identity primary key,
  name text,
  description text
);
```

</TabItem>
</Tabs>

It is best practice to use lowercase and underscores when naming tables. For example: `table_name`, not `Table Name`.

## Columns 

- テーブルの名前を付ける際には、小文字とアンダースコアを使用することをお勧めします。例えば、`Table Name`ではなく`table_name`とします。
- テーブルは`schemas`（スキーマ）に属します。スキーマを明示的に渡さなかった場合、Postgresは`public`（パブリック）スキーマにテーブルを作成したいと仮定します。


### データ型

全ての列は定義済みの型です。PostgreSQLは多くの[デフォルト型](https://www.postgresql.org/docs/current/datatype.html)を提供していますが、デフォルト型がニーズに合わない場合は、独自に設計できます（または拡張機能を使用きます）。

<details>
<summary>表示/非表示 デフォルトのデータ型</summary>
  

| `名称`                             | `エイリアス` | `説明`                                                                         |
|------------------------------------|--------------|--------------------------------------------------------------------------------|
| bigint                             | int8         | 符号付き8バイト整数                                                            |
| bigserial                          | serial8      | オートインクリメントの8バイト整数                                              |
| bit                                |              | 固定長のビット列                                                               |
| bit varying                        | varbit       | 可変長のビット列                                                               |
| boolean                            | bool         | 論理ブーリアン（true/false）                                                   |
| box                                |              | 平面上の長方形の短形                                                           |
| bytea                              |              | バイナリーデータ（バイトの配列）                                               |
| character                          | char         | 固定長の文字列                                                                 |
| character varying                  | varchar      | 可変長文字列                                                                   |
| cidr                               |              | IPv4またはIPv6のネットワークアドレス                                           |
| circle                             |              | 平面上の円                                                                     |
| date                               |              | カレンダーの日付（年、月、日）                                                 |
| double precision                   | float8       | 倍精度の浮動小数点数（8バイト）                                                 |
| inet                               |              | IPv4またはIPv6のホストアドレス                                                 |
| integer                            | int, int4    | 符号付き4バイト整数                                                            |
| interval \[ fields \]              |              | タイムスパン                                                                   |
| json                               |              | テキスト形式のJSONデータ                                                       |
| jsonb                              |              | JSONのバイナリーデータを分解したもの                                            |
| line                               |              | 平面上の無限の線                                                               |
| lseg                               |              | 平面上の線分                                                                   |
| macaddr                            |              | MAC（Media Access Control）アドレス                                            |
| macaddr8                           |              | MAC（Media Access Control）アドレス（EUI-64形式）                              |
| money                              |              | 通貨量                                                                         |
| numeric                            | decimal      | 選択可能な精度の正確な数値                                                     |
| path                               |              | 平面上の幾何学的なパス                                                         |
| pg\_lsn                            |              | PostgreSQLログのシーケンス番号                                                 |
| pg\_snapshot                       |              | ユーザーレベルのトランザクションIDのスナップショット                           |
| point                              |              | 平面上の幾何学的な点                                                           |
| polygon                            |              | 平面上の閉じた幾何学的経路                                                     |
| real                               | float4       | 単精度の浮動小数点数（4バイト）                                                 |
| smallint                           | int2         | 符号付き2バイト整数                                                            |
| smallserial                        | serial2      | オートインクリメントの2バイト整数                                              |
| serial                             | serial4      | オートインクリメントの4バイト整数                                              |
| text                               |              | 可変長文字列                                                                   |
| time \[ without time zone \]       |              | 時間帯（タイムゾーンなし）                                                     |
| time  with time zone               | timetz       | タイムゾーンを含む時刻                                                         |
| timestamp  \[ without time zone \] |              | 日付と時刻（タイムゾーンなし）                                                 |
| timestamp  with time zone          | timestamptz  | タイムゾーンを含む日付と時刻                                                   |
| tsquery                            |              | テキスト検索クエリ                                                             |
| tsvector                           |              | テキスト検索ドキュメント                                                       |
| txid\_snapshot                     |              | ユーザレベルのトランザクションIDのスナップショット（非推奨、pg\_snapshot参照） |
| uuid                               |              | 一意に識別するための識別子 - universally unique identifier                     |
| xml                                |              | XMLデータ                                                                      |


</details>

<br />

<!-- textlint-disable -->
You can "cast" columns from one type to another, however there can be some incompatibilities between types. 
For example, if you cast a `timestamp` to a `date`, you will lose all the time information that was previously saved.

### Primary Keys 

A table can have a "primary key" - a unique identifier for every row of data. A few tips for Primary Keys:


- It's recommended to create a Primary Key for every table in your database.
- You can use any column as a primary key, as long as it is unique for every row.
- It's common to use a `uuid` type or a numbered `identity` column as your primary key. 

```sql
create table movies (
  id bigint generated always as identity primary key
);
```

In the example above, we have:

1. created a column called `id` 
1. assigned the data type `bigint`
1. instructed the database that this should be `generated always as identity`, which means that Postgres will automatically assign a unique number to this column. 
1. Becuase it's unique, we can also use it as our `primary key`.

We could also use `generated by default as identity`, which would allow us to insert our own unique values.

```sql
create table movies (
  id bigint generated by default as identity primary key
);
```

## Loading data 

There are several ways to load data in Supabase. You can load data directly into the database or using the [APIs](/docs/guides/api). 
Use the "Bulk Loading" instructions if you are loading large data sets.

### Basic data loading

<Tabs
defaultValue="SQL"
values={[
  {label: 'SQL', value: 'SQL'},
  {label: 'JavaScript', value: 'JS'},
  {label: 'Dart', value: 'DART'},
]}>
<TabItem value="SQL">

```sql
insert into movies 
  (name, description)
values
  ('The Empire Strikes Back', 'After the Rebels are brutally overpowered by the Empire on the ice planet Hoth, Luke Skywalker begins Jedi training with Yoda.'),
  ('Return of the Jedi', 'After a daring mission to rescue Han Solo from Jabba the Hutt, the Rebels dispatch to Endor to destroy the second Death Star.');
```

</TabItem>
<TabItem value="JS">

```sql
const { data, error } = await supabase
  .from('movies')
  .insert([{ 
    name: 'The Empire Strikes Back', 
    description: 'After the Rebels are brutally overpowered by the Empire on the ice planet Hoth, Luke Skywalker begins Jedi training with Yoda.' 
  }, { 
    name: 'Return of the Jedi', 
    description: 'After a daring mission to rescue Han Solo from Jabba the Hutt, the Rebels dispatch to Endor to destroy the second Death Star.' 
  }])
```

</TabItem>
<TabItem value="DART">

```sql
final res = await supabase
  .from('movies')
  .insert([{ 
    name: 'The Empire Strikes Back', 
    description: 'After the Rebels are brutally overpowered by the Empire on the ice planet Hoth, Luke Skywalker begins Jedi training with Yoda.' 
  }, { 
    name: 'Return of the Jedi', 
    description: 'After a daring mission to rescue Han Solo from Jabba the Hutt, the Rebels dispatch to Endor to destroy the second Death Star.' 
  }]).execute();
```

</TabItem>
</Tabs>

### Bulk data loading 

When inserting large data sets it's best to use PostgreSQL's [COPY](https://www.postgresql.org/docs/current/sql-copy.html) command. 
This loads data directly from a file into a table. There are several file formats available for copying data: text, csv, binary, JSON, etc.

For example, if you wanted to load a CSV file into your movies table:

```csv title="./movies.csv"
"The Empire Strikes Back", "After the Rebels are brutally overpowered by the Empire on the ice planet Hoth, Luke Skywalker begins Jedi training with Yoda."
"Return of the Jedi", "After a daring mission to rescue Han Solo from Jabba the Hutt, the Rebels dispatch to Endor to destroy the second Death Star."
```

You would [connect](/docs/guides/database/connecting-to-postgres#direct-connections) to your database directly and load the file with the COPY command: 

```bash
psql -h DATABASE_URL -p 5432 postgres -U postgres \
  -c "COPY movies FROM './movies.csv';"
```


## Joining tables with Foreign Keys

Tables can be "joined" together using Foreign Keys.

![Foreign Keys](/img/guides/database/foreign-keys.png)

This is where the "Relational" naming comes from, as data typically forms some sort of relationship. 

In our "movies" example above, we might want to add a "category" for each movie (for example, "Action", or "Documentary"). 
Let's create a new table called `categories` and "link" our `movies` table.

```sql
create table categories (
  id bigint generated always as identity primary key,
  name text -- category name
);

alter table movies 
  add column category_id bigint references categories;
```

You can also create "many-to-many" relationships by creating a "join" table.
For example if you had the following situations:

- You have a list of `movies`.
- A movie can have several `actors`.
- An `actor` can perfom in several movies.

<Tabs
defaultValue="SQL"
values={[
  {label: 'SQL', value: 'SQL'},
  {label: 'Dashboard', value: 'UI'},
]}>
<TabItem value="SQL">

```sql
create table movies (
  id bigint generated by default as identity primary key,
  name text,
  description text
);

create table actors (
  id bigint generated by default as identity primary key,
  name text
);

create table performances (
  id bigint generated by default as identity primary key,
  movie_id bigint not null references movies,
  actor_id bigint not null references actors
);
```

</TabItem>
<TabItem value="UI">

<iframe
className="w-full video-with-border"
width="640"
height="420"
src="https://www.youtube-nocookie.com/embed/TKwF3IGij5c"
frameBorder="1"
allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
allowFullScreen
></iframe>

</TabItem>
</Tabs>


## Schemas 

Tables belong to `schemas`. Schemas are a way of organizing your tables, often for security reasons.

![Schemas and tables](/img/guides/database/schema-tables.png)

If you don't explicitly pass a schema when creating a table, Postgres will assume that you want to create the table in the `public` schema. 

We can create schemas for organizing tables. For example, we might want a private schema which is hidden from our API: 

<!-- textlint-enable -->

```sql
create schmea private;
```

Now we can create tables inside the `private` schema:

```sql
create table salaries (
  id bigint generated by default as identity primary key,
  salary bigint not null,
  actor_id bigint not null references public.actors
);
```

## Resources

- [Official Docs: Create table](https://www.postgresql.org/docs/current/sql-createtable.html)
- [PostgreSQL Tutorial: Create tables](https://www.postgresqltutorial.com/postgresql-tutorial/postgresql-create-table/)
- [PostgreSQL Tutorial: Add column](https://www.postgresqltutorial.com/postgresql-tutorial/postgresql-add-column/)
